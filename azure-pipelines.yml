# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- main

pool: 
  Name: Default
  Demands:
  - agent.name eq Desktop

variables:
  - name: build
    value: 0.1
  - name: description
    value: 'Initial setup build with just HelloWorld code.'
steps:
- script: |
    IF exist StockSync (rmdir /Q /S StockSync)
  displayName: 'Delete StockSync folder if exists.'

- script: |
    git clone https://$(AdminAccess)@dev.azure.com/ProBonoTech/StockSync/_git/StockSync
  displayName: 'Cloning StockSync Repo'

- script: |
    cd StockSync
    git remote set-url origin https://mizakiharuno:$(GitHubAccess)@github.com/mizakiharuno/StockSync.git
    git pull
    echo *.yml >> .gitignore
    git add -A
    git config --global user.email "mizakiharuno@gmail.com"
    git config --global user.name "AzurePipeline"
    git commit -m "Removed .yml files. Deploying Build $(build)." -m "Description: $(description)"
    git push